# https://docs.wandb.ai/guides/sweeps/sweep-config-keys/#distribution-options-for-random-and-bayesian-search
program: interactive_navigation/scripts/rsl_rl/train.py
# program: scripts/rsl_rl/train.py
description: "Sweep over hyperparameters for metra sac anymal"
method: bayes  # or 'grid', 'random'
metric:
  name: Metra/super_phi_metric  # wandb metric to optimize
  goal: maximize  # 'minimize' or 'maximize' if optimizing a loss
parameters:
  env.scene.num_envs:
    values: [8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096]
  agent.num_transitions_per_episode:
    min: 1000
    max: 250000
    distribution: int_uniform
  agent.seed:
    min: 0
    max: 1000
  agent.metra.batch_size:
    values: [128, 256, 512, 1024]
  agent.metra.replay_buffer_size_total:
    min: 100000
    max: 2500000
    distribution: int_uniform
  agent.metra.num_sgd_steps_metra:
    min: 10
    max: 250
    distribution: int_uniform
  agent.metra.sac_hyperparameters.gamma:
    min: 0.95
    max: 0.995
    distribution: log_uniform_values
  agent.metra.sac_hyperparameters.polyak:
    min: 0.001
    max: 0.01
    distribution: log_uniform_values
  agent.metra.sac_hyperparameters.lr:
    min: 0.00005
    max: 0.001
    distribution: log_uniform_values
  agent.metra.non_metra_reward_scale:
    min: 0.0
    max: 1.0
    distribution: uniform

command:
  - /isaac-sim/python.sh
  - ${program}
  - --task=Isaac-METRA-Anymal-D-v0 
  - --logger=wandb
  - --headless
  - --video
  - --video_length=100
  - --video_interval=100000
  - ${args_no_hyphens}
