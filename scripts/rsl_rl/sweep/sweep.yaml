# https://docs.wandb.ai/guides/sweeps/sweep-config-keys/#distribution-options-for-random-and-bayesian-search
program: interactive_navigation/scripts/rsl_rl/train.py
# program: scripts/rsl_rl/train.py
description: "Sweep over hyperparameters for metra ppo anymal"
method: bayes  # or 'grid', 'random'
metric:
  name: Metra/reward_mean  # wandb metric to optimize
  goal: maximize  # 'minimize' or 'maximize' if optimizing a loss
parameters:
# env
  env.scene.num_envs:
    values: [4096]
  agent.num_steps_per_env:
    values: [25, 49, 97]
  agent.empirical_normalization:
    values: [True, False]
  agent.seed:
    min: 0
    max: 1000
# metra
  agent.metra.state_representation_args.layer_norm:
    values: [False]
  agent.metra.skill_dim:
    values: [2, 3, 4]
  agent.metra.lr:
    min: 1.0e-4
    max: 1.0e-2
    distribution: log_uniform_values
  agent.metra.lr_tau:
    min: 5.0e-5
    max: 5.0e-4
    distribution: log_uniform_values
  agent.metra.sigma:
    min: 0.1
    max: 10.0
    distribution: log_uniform_values
# algorithm
  agent.algorithm.entropy_coef:
    min: 0.0025
    max: 0.01
    distribution: log_uniform_values
  agent.algorithm.learning_rate:
    min: 5.0e-5
    max: 2.5e-3
    distribution: log_uniform_values
  agent.algorithm.clip_param:
    min: 0.1
    max: 0.3
    distribution: uniform

    # TODO gamma and other ppo params


command:
  - /isaac-sim/python.sh
  - ${program}
  - --task=Isaac-METRA-Anymal-D-v0
  - --logger=wandb
  - --headless
  - --video
  - --video_length=100
  - --video_interval=50000
  - ${args_no_hyphens}
